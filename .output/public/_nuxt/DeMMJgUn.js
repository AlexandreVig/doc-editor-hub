import{g as U,r as V,h as C,i as z,ah as j,o as q,k as M,w as o,b as e,l as s,a as t,y as S,q as $,av as I,aw as A,az as G,ay as E,O as H,t as k,d as L}from"./BDinhLvt.js";import{c as P,a as w,_ as F,b as T,d as B}from"./C1yNvVha.js";const O={class:"flex justify-between"},Y=t("div",{class:"flex items-center"},[t("div",{class:"-mt-6 ml-4"},[t("p",{class:"w-full text-slate-400"},"Mot de passe"),t("h1",{class:"font-bold text-2xl leading-5"},"Modification du mot de passe")])],-1),J={class:"flex py-14 gap-x-8 gap-y-12"},K=U({__name:"updatePasswordModal",emits:["success","failure","cancel"],setup(N,{emit:g}){const y=P({currentPassword:w().min(6,"Doit contenir au moins 6 caractères").required("Required"),password:w().min(6,"Doit contenir au moins 6 caractères").required("Required"),passwordConfirmation:w().min(6,"Doit contenir au moins 6 caractères").required("Required")}),l=V({currentPassword:void 0,password:void 0,passwordConfirmation:void 0}),m=C();async function v(n){if(n.data.password!==n.data.passwordConfirmation){d("The passwords don't match");return}m.post("/api/auth/update-password",n.data).then(i=>{localStorage.setItem("user",i.data.token),p("Your password has been updated")}).catch(i=>{d(`An error occurred: ${i.response.statusText}`)})}const a=g;function p(n){a("success",n)}function d(n){a("failure",n)}function r(){a("cancel")}const c=z(!1);return j(l,()=>{c.value=!0}),(n,i)=>{const _=S,u=$,f=F,x=T,h=I,R=B,D=A;return q(),M(D,{ui:{width:"w-full max-w-fit sm:max-w-fit"},"prevent-close":""},{default:o(()=>[e(R,{schema:s(y),state:s(l),class:"space-y-4",onSubmit:v},{default:o(()=>[e(u,{class:"absolute top-10 -left-20 flex items-center justify-center w-12 h-12 rounded-full",color:"gray",onClick:r},{default:o(()=>[e(_,{name:"i-heroicons-x-mark-16-solid",class:"text-2xl"})]),_:1}),e(h,{ui:{base:"w-full h-fit",ring:"",divide:"divide-y divide-gray-200 dark:divide-gray-700",header:{padding:"px-4 py-10"}}},{header:o(()=>[t("div",O,[Y,e(u,{class:"flex items-center justify-center w-12 h-12 rounded-full",disabled:!s(c),type:"submit"},{default:o(()=>[e(_,{name:"i-heroicons-check-16-solid",class:"text-2xl"})]),_:1},8,["disabled"])])]),default:o(()=>[t("div",J,[e(x,{size:"xl",label:"Mot de passe actuel",name:"currentPassword",ui:{label:{base:"block font-medium font-semibold text-gray-700 dark:text-gray-200"}}},{default:o(()=>[e(f,{type:"password",modelValue:s(l).currentPassword,"onUpdate:modelValue":i[0]||(i[0]=b=>s(l).currentPassword=b),icon:"i-heroicons-lock-closed-20-solid",color:"white",variant:"outline",size:"xl",trailing:""},null,8,["modelValue"])]),_:1}),e(x,{size:"xl",label:"Nouveau mot de passe",name:"password",ui:{label:{base:"block font-medium font-semibold text-gray-700 dark:text-gray-200"}}},{default:o(()=>[e(f,{type:"password",modelValue:s(l).password,"onUpdate:modelValue":i[1]||(i[1]=b=>s(l).password=b),icon:"i-heroicons-lock-closed-20-solid",color:"white",variant:"outline",size:"xl",trailing:""},null,8,["modelValue"])]),_:1}),e(x,{size:"xl",label:"Confirmation du mot de passe",name:"passwordConfirmation",ui:{label:{base:"block font-medium font-semibold text-gray-700 dark:text-gray-200"}}},{default:o(()=>[e(f,{type:"password",modelValue:s(l).passwordConfirmation,"onUpdate:modelValue":i[2]||(i[2]=b=>s(l).passwordConfirmation=b),icon:"i-heroicons-lock-closed-20-solid",color:"white",variant:"outline",size:"xl",trailing:""},null,8,["modelValue"])]),_:1})])]),_:1})]),_:1},8,["schema","state"])]),_:1})}}}),Q={class:"flex justify-between"},W={class:"flex items-center"},X={class:"flex items-center justify-center w-12 h-12 rounded-full bg-slate-200"},Z={class:"-mt-6 ml-4"},ee=t("p",{class:"w-full text-slate-400"},"Utilisateur",-1),te={class:"font-bold text-2xl leading-5"},se={class:"w-1/2"},oe={class:"flex items-center p-5 bg-slate-100 rounded-xl"},ae={class:"h-36 w-36 mr-5 flex justify-center"},ne=["src"],le={class:"font-bold text-lg leading-5"},ie={class:"text-slate-400 flex items-center font-medium my-0.5"},de={class:"grid grid-cols-2 py-14 gap-x-8 gap-y-12"},ue=U({__name:"index",setup(N){const g=P({name:w().required("Required"),email:w().email("Invalid email").required("Required")});async function y(r){let c={name:r.data.name,email:r.data.email};a.put(`/users/${a.userId}`,c).then(()=>{p.value=!1,a.isLogged(),l.add({title:"Vos informations ont été mis à jour !",id:"modal-success",color:"green"})}).catch(n=>{console.error(n),l.add({title:"Une erreur c'est produite !",id:"modal-failure"})})}const l=G(),m=E(),v=()=>{m.open(K,{onSuccess(r){l.add({title:r,id:"modal-success",color:"green"}),m.close()},onFailure(r){l.add({title:r,id:"modal-failure"})},onCancel(){m.close()}})},a=C();H(()=>{a.setNavbar(!0)});const p=z(!1),d=V({name:a.name,email:a.email});return j(d,()=>{p.value=!0}),(r,c)=>{const n=S,i=$,_=F,u=T,f=I,x=B;return q(),M(x,{schema:s(g),state:s(d),class:"space-y-4 w-full h-fit",onSubmit:y},{default:o(()=>[e(f,{ui:{base:"w-full h-fit",ring:"",divide:"divide-y divide-gray-200 dark:divide-gray-700",header:{padding:"px-4 py-10"},body:{padding:"",base:"h-full px-24 p-4 divide-y divide-gray-200 dark:divide-gray-700 flex justify-center"},footer:{padding:"p-4"}}},{header:o(()=>[t("div",Q,[t("div",W,[t("div",X,[e(n,{name:"i-heroicons-users",class:"text-2xl"})]),t("div",Z,[ee,t("h1",te,k(s(a).name),1)])]),e(i,{class:"flex items-center justify-center w-12 h-12 rounded-full",disabled:!s(p),type:"submit"},{default:o(()=>[e(n,{name:"i-heroicons-check-16-solid",class:"text-2xl"})]),_:1},8,["disabled"])])]),default:o(()=>[t("div",se,[t("div",oe,[t("div",ae,[t("img",{class:"w-full flex justify-center items-center border-white border-8 rounded-full",src:`https://www.gravatar.com/avatar/${s(a).userHash}?s=200&d=retro`,alt:"Avatar"},null,8,ne)]),t("div",null,[t("h1",le,k(s(a).name),1),t("p",ie,[e(n,{name:"i-heroicons-at-symbol-16-solid mr-1"}),L(" "+k(s(a).email),1)])])]),t("div",de,[e(u,{size:"xl",label:"Username",name:"name",ui:{label:{base:"block font-medium font-semibold text-gray-700 dark:text-gray-200"}}},{default:o(()=>[e(_,{icon:"i-heroicons-user-circle-20-solid",color:"white",variant:"outline",size:"xl",modelValue:s(d).name,"onUpdate:modelValue":c[0]||(c[0]=h=>s(d).name=h),trailing:""},null,8,["modelValue"])]),_:1}),e(u,{size:"xl",label:"E-mail",name:"email",ui:{label:{base:"block font-medium font-semibold text-gray-700 dark:text-gray-200"}}},{default:o(()=>[e(_,{icon:"i-heroicons-envelope-20-solid",color:"white",variant:"outline",size:"xl",modelValue:s(d).email,"onUpdate:modelValue":c[1]||(c[1]=h=>s(d).email=h),trailing:""},null,8,["modelValue"])]),_:1}),e(u,{size:"xl",label:"Mot de passe",name:"password",ui:{label:{base:"block font-medium font-semibold text-gray-700 dark:text-gray-200"}}},{default:o(()=>[e(i,{color:"primary",size:"xl",icon:"i-heroicons-lock-closed-20-solid",label:"Mettre à jour",trailing:"",onClick:v})]),_:1})])])]),_:1})]),_:1},8,["schema","state"])}}});export{ue as default};
